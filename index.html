<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Node.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<img src="img/nodejs-new-pantone-white.png" alt="" class="stretch">
				</section>
				<section>
					<h1>Présentation</h1>
					<ul>
						<li>Christophe Sensebé</li>
						<li>Développeur web</li>
						<li>Je travaille à FMGS concept</li>
						<li>Je prépare un titre pro CDI au CEFIM</li>
						<li>J'ai appris à programmer avec node.js et python</li>
					</ul>
					<aside class="notes">
						<p>Je vais vous présenter une introduction sur node.js, en vous présentant la plateforme, son fonctionnement, Pour quoi elle à été concue, ce qu'on peut faire avec, Et des ressources si vous souhaiter vous y mettre.</p>
					</aside>
				</section>
				<section>
					<h1>Qu'est ce que c'est</h1>
				</section>
				<section>
					<p>Plateforme logicielle libre, qui fourni un environement d'éxécution javascript coté serveur</p>
					<p>Node.js utilise un modèle d'I/O évènementielle non bloquant, capable de servir un grand nombre de connections concurrentes</p>
				</section>
				<section>
					<p>Node.js à été créé pour fournir une plateforme d'I/O stable et performante.</p>
				</section>
				<section>
					<section><h2>En combinant:</h2></section>
					<section>
						<img src="/img/v8-logo.png" alt="" class="stretch">
						<p>Le moteur javascript v8 de chrome</p>
					</section>
					<section>
						<img src="/img/libuvLogo.png" alt="" class="stretch">
						<p>Libuv une bibliothèque C multi plateforme chargée de la gestion de la boucle d'évènements, d'un pool de threads et de la résolution asynchrone des opérations d'I/O.</p>
					</section>
					<section>
						<img src="/img/event-loop.jpg" alt="" class="stretch">
						<p>La boucle d'évènements de node.js</p>
						<aside class="notes">
							<p>De façon simplifiée</p>
							<p>La boucle d'évènements enregistre les évènements, délègue leur résolution à un pool de threads, Une la tache acomplie, une fonction de rappel est exécutée avec le résultat de l'opération</p>
						</aside>
					</section>
				</section>
				<section>
					<p>De base node fourni une API d'assez bas niveau, avec des modules pour interagir avec le système de fichiers, le reseau, la manipulation de données binaires, des fonctions cryptographiques...</p>
					<p>Il est d'étendre les fonctionalitées de la plateforme via des add-on écris en C ou C++</p>
					<a href="https://nodejs.org/api/">https://nodejs.org/api/</a>
					<aside class="notes">La doc de node est diponible à l'adresse suivante</aside>
				</section>
				<section>
					<img src="/img/npmLogo.png" alt="" class="stretch">
					<p>Node.js fournit un gestionnaire de paquets. qui permet: d'importer, de publier des modules et bibliothèques supplémentaires ainsi que de gérer les dépendances d'un projet.</p>
				</section>
				<section>
					<p>Node.js est disponible pour Linux, MacOS, Windows</p>
					<p>Les applications Node.js sont écrites en javascript ou n'importe quel language transpilable en javascript (CoffeScript, Dart, TypeScript...)</p>
				</section>
				<aside class="notes">Aussi images docker, SunOs...</aside>
				<section>
					<h1>Comment ça marche</h1>
				</section>
				<section>
					<section>
						<h2>Installation</h2>
						<img src="/img/Node%20install.png" alt="" class="stretch">
						<p>Récupération d'un installeur ou des fichiers exécutables depuis le site officiel</p>
						<a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a>
					</section>
					<section>
						<h2>Utilisation de nvm</h2>
						<img src="/img/nvm.png" alt="" class="stretch">
						<a href="https://github.com/creationix/nvm">https://github.com/creationix/nvm</a>
						<aside class="notes">Nvm est un outil en ligne de commande qui permet d'installer et de gérer plusieurs versions de node.js sur un même système.</aside>
					</section>
				</section>
				<section>
					<section>
						<h2>Fonctionnement</h2>
						<img src="/img/nonBlockingIO.jpg" alt="" class="stretch">
						<aside class="notes">
							<ul>
								<li>Les requêtes qui arrivent sont enregistrées par la boucle d'évènements</li>
								<li>l'opération à éxécuter est déléguée au pool de threads géré par libuv</li>
								<li>Une fois l'opération terminée la fonction de rappel enregistrée avec l'opération est éxécutée</li>
							</ul>
							<p>De part la nature mono thread du javascript, toute opération bloquante, bloque complètement la boucle d'évènements</p>
						</aside>
					</section>
					<section>
						<h2>Modèle d'I/O classique</h2>
						<img src="/img/blockingIO.jpg" alt="" class="stretch">
						<aside class="notes">A comparer au modèle d'I/O plus classique ou pour chaque requête un nouveau thread est crée</aside>
					</section>
					<section>
						<p>Afin de ne pas bloquer le thread principal, node.js fourni une API principalement basée sur les fonctons de rappel (callbacks).</p>
					</section>
				</section>
				<section>
					<section>
						<h2>Exemples</h2>
					</section>
					<section>
						<h3>Lecture d'un fichier</h3>
						<pre>
						<code data-trim data-noescape>
							const fs = require('fs');

							fs.readFile('myFile.md', 'utf-8', (err, data) => {
								if(err) {
									console.log(err);
									return;
								}
								console.log(data);
							}
						</code>
					</pre>
						<aside class="notes">
							<ul>
								<li>On commence par importer le module fs (filesystem)</li>
								<li>on fait appel à la fonction readFile qui prend en paramètres le chemin du fichier, l'encodage et une fonction de rappel</li>
								<li>le callback prend en paramètre un objet erreur, et en second le contenu du fichier</li>
							</ul>
						</aside>
					</section>
					<section>
						<h3>Serveur http</h3>
						<pre>
							<code data-trim data-noescape>
								const http = require('http');
								const port = 8000;

								let server = http.createServer((request, response) => {
									response.end('Hello world');
								});

								server.listen(port);
							</code>
						</pre>
						<aside class="notes">
							<p>Un autre exemple avec le module http.
								On importe le module, on crée un serveur, et on écoute sur le port passé en paramètre.</p>
							<p>Il est possible pour rendre l'api plus facile à utiliser d'envelopper dans des promesses (bluebird), et d'utiliser async/await (node 7.6+).</p>
						</aside>
					</section>
				</section>
				<section>
					<section>
						<h2>Npm le gestionnaire de paquets</h2>
					</section>
					<section>
						<h3>Le fichier package.json</h3>
						<pre>
							<code data-trim data-noescape>
								{
									"name": "ledserver",
									"version": "0.0.0",
									"private": true,
									"scripts": {
										"start": "node ./bin/www"
									},
									"dependencies": {
										"body-parser": "~1.16.0",
										"cookie-parser": "~1.4.3",
										"debug": "~2.6.0",
										"express": "~4.14.1",

										...

							</code>
						</pre>
						<aside class="notes">A la racine d'un projet node on trouve un fichier package.json qui décrit des meta-données, des scripts et les dépendances du projet. Pour la gestion des dépendances node utilise le versioning sémantique (major.minor.patch).
							<ul>
								<li>version exacte</li>
								<li>version mineure: ~</li>
								<li>version majeure: ^</li>
								<li>n'importe quelle version: $</li>
							</ul>
						</aside>
					</section>
					<section>
						<h3>Quelques commandes</h3>
						<pre>
							<code data-trim data-noescape="">
								$ npm init
							</code>
						</pre>
						<pre>
							<code data-trim data-noescape="">
								$ npm install
							</code>
						</pre>
						<pre>
							<code data-trim data-noescape>
								$ npm shrinkwrap
							</code>
						</pre>
						<a href="https://docs.npmjs.com/">https://docs.npmjs.com/</a>
						<aside class="notes">
							<ul>
								<li>npm init pour initialiser un fichier package.json</li>
								<li>npm install pour installer les dépendaces décrites dans le package ou un package passé en paramètre</li>
								<li>npm shrinkwrap vérouille l'arbre de dépendances</li>
							</ul>
							<p>possibilité d'installer un module depuis un dépot git</p>
						</aside>
					</section>
					<section>
						<h3>Le site NPM</h3>
						<img src="/img/screenNPM.png" alt="" class="stretch">
						<a href="https://www.npmjs.com/">https://www.npmjs.com/</a>
						<aside class="notes">
							<p>Le site NPM recense les plus de 400000 paquets publiés dans le registre public de npm, la doc de npm ainsi que des services (registres privés)</p>
						</aside>
					</section>
				</section>
				<section>
					<h1>Pour quoi faire</h1>
				</section>
				<section>
					<p>
						Node.js à été créé afin de développer des applications gourmandes en termes d'entrée/sortie.
					</p>
				</section>
				<section>
					<section>
						<h2>Pro / con</h2>
					</section>
					<section>
						<h3>Adapté pour</h3>
						<ul>
							<li>Applications web en temps réel</li>
							<li>Chat</li>
							<li>Application de monitoring</li>
							<li>Micro tâches</li>
							<li>Proxi en facade de différents services</li>
							<li>API construite sur une base Objet (mongo)</li>
							<li>Streaming</li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Toute application gourmande en termes d'I/O, utilisation de websockets</li>
								<li>Micro taches (aws lambda, fonctions google cloud et azure)</li>
								<li>I/O performante et capacité de communiquer "facilement" avec une grande variété de protocoles (http, websockets, tcp, udp...)</li>
								<li>mongo: un seul language et format de données de bout en bout</li>
								<li>API de streaming incluse de base dans la plateforme</li>
							</ul>
						</aside>
					</section>
					<section>
						<h3>Aussi adapté</h3>
						<p>Application web coté serveur</p>
						<ul>
							<li>Un seul langage utilisé</li>
							<li>Outillage avec npm</li>
							<li>Rendu coté serveur (single page app)</li>
						</ul>
						<aside class="notes">
							<p>lister les avantages de cette approche (cf slide)</p>
						</aside>
					</section>
					<section>
						<h3>moins adapté / pas adapté</h3>
						<ul>
							<li>Applications gourmandes en temps de calcul</li>
							<li>Calcul scientifique</li>
							<li>Traitement audio/video</li>
							<li>Embarqué</li>
							<li>Utilisation avec une base relationelle</li>
							<li>CMS</li>
						</ul>
						<aside class="notes">
							<p>Tout ce qui est susceptible de bloquer la boucle d'évènements, le fait que le js est mono thread et peu adapté aux opérations intensives en terme de calcul.</p>
							<p>traitement A/V, calcul scientifique bibliothèques matures présentes dans d'autre languages (java, python, c...)</p>
							<p>db relationelle/cms, possible mais outils plus matures dans d'autres languages</p>
						</aside>
					</section>
				</section>
				<section data-state="ledOff">
					<section><h2>Écosystème</h2></section>
					<section>
						<h3>Frameworks web</h3>
						<ul>
							<li>Express <a href="http://expressjs.com/fr/">http://expressjs.com/fr/</a></li>
							<li>HAPI <a href="https://hapijs.com/">https://hapijs.com/</a></li>
							<li>Koa <a href="http://koajs.com/">http://koajs.com/</a></li>
							<li>Meteor <a href="https://www.meteor.com/">https://www.meteor.com/</a></li>
							<li>Restify <a href="http://restify.com/">http://restify.com/</a></li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Express framework "par défaut" de l'écosystème node, avec hapi et koa(async) comme alternatives</li>
								<li>Meteor démarche d'utiliser le même code coté serveur et client</li>
								<li>Restify proche d'express, dédié à la réalisation d'API rest</li>
							</ul>
						</aside>
					</section>
					<section>
						<h3>Outilage javascript</h3>
						<ul>
							<li>Grunt</li>
							<li>Gulp</li>
							<li>Webpack</li>
							<li>Cordova cli</li>
							<li>Create react app</li>
							<li>Angular cli</li>
						</ul>
						<aside class="notes">
							<p>La quasi totalité des outils de l'écosystème javascript utilisent node.js.</p>
						</aside>
					</section>
					<section>
						<h3>Appli desktop</h3>
						<p>Electron, <a href="https://electron.atom.io/">https://electron.atom.io/</a></p>
						<ul>
							<li>Slack</li>
							<li>Atom</li>
							<li>Visual studio code</li>
							<li>Postman</li>
						</ul>
						<aside class="notes">
							<p>Electron framework utilisant node et chromuim dédié à la réalisation d'applications de bureau, exemples: Slack, Atom, Visual studio code, Postman. Moins performants que d'autres languages mais permet d'utiliser les technos/compétences web pour réaliser une appli de bureau</p>
						</aside>
					</section>
					<section>
						<h3>ET plein d'autres</h3>
						<ul>
							<li>socket.io</li>
							<li>Mongoose</li>
							<li>Forever</li>
							<li>PM2</li>
							<li>Johnny-Five</li>
						</ul>
						<aside class="notes">
							<ul>
								<li>socket.io -> websockets</li>
								<li>Mongoose odm pour mongoDb (validation, casting, requêtes...)</li>
								<li>Forever, permet de garder un script actif</li>
								<li>PM2: monitoring, relancer un script, clusters, load balancing</li>
								<li>Plateforme pour la robotique et internet of things, plus un outil de prototypage, mais permet d'utiliser des compétence de dev web pour communiquer avec des objets</li>
							</ul>
						</aside>
					</section>
				</section>
				<section>
					<section data-state="ledOff">
						<h2>Exemple avec websocket + johnny-Five</h2>
						<aside class="notes">
							<p>Un exemple de serveur node utilisant des websockets et johnny-five</p>
							<p>La présentation est reliée par websocket avec un serveur express js qui utilise johnny-five branché sur un arduino avec une led RGB</p>
						</aside>
					</section>
					<section data-state="ledWhite">
						<h1>Led ON</h1>
						<pre>
							<code data-trim data-noescape>
								led.turnOn();
							</code>
						</pre>
						<aside class="notes">
							La led s'allume
						</aside>
					</section>
					<section data-state="ledRed">
						<h1>Rouge</h1>
						<pre>
							<code data-trim data-noescape>
								led.setColor({
									red: 255,
									green: 0,
									blue: 0
								});
							</code>
						</pre>
						<aside class="notes">
							La couleur change
						</aside>
					</section>
					<section data-state="ledGreen">
						<h1>Vert</h1>
						<pre>
							<code data-trim data-noescape>
								led.setColor({
									red: 0,
									green: 255,
									blue: 0
								});
							</code>
						</pre>
					</section>
					<section data-state="ledBlue">
						<h1>Bleu</h1>
						<pre>
							<code data-trim data-noescape>
								led.setColor({
									red: 0,
									green: 0,
									blue: 255
								});
							</code>
						</pre>
					</section>
				</section>
				<section data-state="ledOff">
					<section>
						<h1>Pour s'y mettre</h1>
					</section>
					<section>
						<ul>
							<li>Stackoverflow <a href="http://stackoverflow.com/questions/2353818/how-do-i-get-started-with-node-js">http://stackoverflow.com/questions/2353818/how-do-i-get-started-with-node-js</a></li>
							<li>Page github <a href="https://github.com/maxogden/art-of-node/#the-art-of-node">https://github.com/maxogden/art-of-node/#the-art-of-node</a></li>
							<li>Nodeschool <a href="https://nodeschool.io/">https://nodeschool.io/</a></li>
							<li>CodeSchool <a href="https://www.codeschool.com/">https://www.codeschool.com/</a></li>
							<li>OpenClassRooms <a href="https://openclassrooms.com/courses/des-applications-ultra-rapides-avec-node-js">https://openclassrooms.com/courses/des-applications-ultra-rapides-avec-node-js</a></li>
							<li>Risingstack <a href="https://blog.risingstack.com/node-hero-tutorial-getting-started-with-node-js/">https://blog.risingstack.com/node-hero-tutorial-getting-started-with-node-js/</a></li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Une page stackoverflow qui rescense des ressources pour commencer avec node.js</li>
								<li>Un article qui est une bonne introduction</li>
								<li>Des cours sur codeschool node, express, mongo (payant)</li>
								<li>Cours en français sur openClassroom</li>
								<li>Série d'articles de blog sur risinstack, qui vont de l'intro a node au déployement en production</li>
							</ul>
						</aside>
					</section>
				</section>
				<section>
					<h1>Des questions?</h1>
				</section>
				<section>
					<h1>Merci</h1>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<script src="js/socket.io.js"></script>

		<script>
			// connect to webSocket server
			const socket = io('http://localhost:4000');
			const ledColors = {
			    white: {red: 255, green: 255, blue: 255},
			    red: {red: 255, green: 0, blue: 0},
				green: {red: 0, green: 255, blue: 0},
				blue: {red: 0, green: 0, blue: 255}
			};
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				]
			});
			// listen to leds events and emit them to the webSocket server
			Reveal.addEventListener('ledWhite', () => {
                socket.emit('turnOn', {color : ledColors.white});
			});

            Reveal.addEventListener('ledRed', () => {
                socket.emit('changeColor', {color : ledColors.red});
            });

            Reveal.addEventListener('ledGreen', () => {
                socket.emit('changeColor', {color : ledColors.green});
            });

            Reveal.addEventListener('ledBlue', () => {
                socket.emit('changeColor', {color: ledColors.blue});
            });

            Reveal.addEventListener('ledOff', () => {
               	socket.emit('turnOff', {});
			});

		</script>
	</body>
</html>
